<!DOCTYPE html>
<html>
<head>
    <title>Edit Reservation - Fazbear Entertainment Labs</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" type="image/x-icon" href="favicon/freddyfazbear.png">
    <style>
        .subcontainer {
            border-radius: 8px;
            margin-top: -0.3px;
            text-align: center;
            width: 440px;
            background-color: #e54c44;
        }
        h2 {
            font-family: "Press Start 2P", system-ui;
            font-size: 15px;
            margin-bottom: 10px;
            font-weight: 400;
            line-height: 1.2;
            color: #fffcef;
        }
        .content {
            display: flex;
            flex-direction: column;
        }
        .content p {
            margin: 0;
        }
        .schedule-list {
            background-color: #fffcef;
            width: 440px;
            margin: 20px auto;
            padding: 20px;
            border-radius: 8px;
            border: none;
            overflow: hidden; /* Clear floats */
            position: relative; /* Add position relative */
        }
        .float-right1 {
            position: absolute; /* Change position to absolute */
            right: 20px; /* Adjust right positioning */
            text-align: right; /* Align text to the right */
        }
        .float-right2 {
            position: absolute; /* Change position to absolute */
            right: 20px; /* Adjust right positioning */
            top: 38px;
            text-align: right; /* Align text to the right */
        }
        .float-left {
            text-align: left; /* Align text to the left */
        }
    </style>
    <script src = "js/User.js"></script>
    <script src="js/CurrentUser.js"></script>
    <script src="js/Reservation.js"></script>
</head>
<body>
    <nav>
        <div class="homebutton"><a href="dashboard.html"><img id="home-icon" src="icons/home.png"> Home</a></div>
        <div class="dropdown">
            <a href="userviewprofile.html">User Profile</a>
            <div class="dropdown-content">
                <a href="userviewprofile.html">View Profile</a>
                <a href="usereditprofile.html">Edit Profile</a>
                <a href="userdelete.html">Delete Profile</a>
            </div>
        </div>
        <div class="dropdown">
            <a href="reserve.html">Reserve</a>
            <div class="dropdown-content">
                <a href="reserve.html">Reserve</a>
                <a href="reserveedit.html">Edit Reservation</a>
                <a href="reservesee.html">See Reservations</a>
                <a href="reserveviewslots.html">View Available Slots</a>
            </div>
        </div>
        <div class="dropdown">
            <a href="#">Search</a>
            <div class="dropdown-content">
                <a href="searchusers.html">Search Users</a>
                <a href="searchslots.html">Search Slots</a>
            </div>
        </div>
        <div><a href="userlogout.html">Logout</a></div>
    </nav>
    <div class="container">
        <h1>Edit Reservation</h1>
        <div class="subcontainer">
            <h2>Select Reservation to Edit</h2>
            <div id="buttonsContainer"></div> <!-- Container for dynamic buttons -->
        </div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            var currentUser = getCurrentUser();

            if (currentUser) {
                name(currentUser);
            }
        });

        function name(user) {
            if (user.status == 'T'){
                var reservations = getAllReservations();
            }
            else{
                var reservations = getReservations(user.username);
            }
            generateButtons(reservations);
        }

        function generateButtons(reservations) {
            var buttonsContainer = document.getElementById("buttonsContainer");

            // Clear existing buttons (if any)
            buttonsContainer.innerHTML = '';

            // Generate buttons based on the number of reservations
            reservations.forEach(function (reservation) {
                var button = document.createElement('button');
                button.classList.add('schedule-list');
                
                // Create content for the button
                var content = document.createElement('div');
                content.classList.add('content');
                
                var labTitle = document.createElement('p');
                labTitle.textContent = reservation.labTitle;
                labTitle.classList.add('float-left');
                
                var seatNumber = document.createElement('p');
                seatNumber.textContent = reservation.seatNum;
                seatNumber.classList.add('float-left');
                
                if (reservation.anonymous) {
                    var anonimity = document.createElement('p');
                    anonimity.textContent = 'Anonymous';
                    anonimity.classList.add('float-left');
                    content.appendChild(anonimity); // Append to content
                } else {
                    var nameElement = document.createElement('p'); // Renamed variable to avoid conflict
                    nameElement.textContent = reservation.student;
                    nameElement.classList.add('float-left');
                    content.appendChild(nameElement); // Append to content
                }

                
                var reserveTime = document.createElement('p');
                reserveTime.textContent = 'Reserve Time: ' + reservation.reserveTime;
                reserveTime.classList.add('float-right1');
                
                var requestTime = document.createElement('p');
                requestTime.textContent = 'Request Time: ' + reservation.requestTime;
                requestTime.classList.add('float-right2');
                
                content.appendChild(labTitle);
                content.appendChild(seatNumber);
                content.appendChild(reserveTime);
                content.appendChild(requestTime);
                
                button.appendChild(content);

                button.onclick = function () {
                    changeSched(reservation.id); // Pass reservation id to changeSched function
                };
                
                buttonsContainer.appendChild(button);
            });
        }

        function changeSched(reservationId) {
            // Add your logic to handle the reservation change
            window.location.href = 'reservesaveedit.html?id=' + reservationId; // Example: Pass reservation id in URL
        }
    </script>
</body>
</html>